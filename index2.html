<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Friday — AI Songwriter (created by Mr. Hemanthravi)</title>
  <meta name="description" content="Friday AI Songwriter — Original (Friday 2.5 Pro) + Corrected (Friday 2.4). All-in-one single file." />
  <style>
    /* ---- Reset & base ---- */
    :root{
      --bg:#f4f7f6;
      --card:#fff;
      --muted:#666;
      --accent:#007bff;
      --accent-2:#0056b3;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:var(--bg);
      color:#1b1b1b;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:28px;
      display:flex;
      align-items:flex-start;
      justify-content:center;
    }

    main{
      width:100%;
      max-width:820px;
      background:var(--card);
      border-radius:12px;
      padding:26px;
      box-shadow:0 8px 30px rgba(12,20,30,0.06);
      margin-bottom:28px;
    }

    header{display:flex;gap:16px;align-items:center;justify-content:space-between}
    .brand{
      display:flex;
      gap:14px;
      align-items:center;
    }
    .logo{
      width:56px;height:56px;border-radius:12px;
      display:grid;place-items:center;
      background:linear-gradient(135deg,#0ea5e9 0%, #7c3aed 100%);
      color:white;font-weight:700;font-size:18px;
      box-shadow:0 6px 18px rgba(12,20,30,0.08);
    }
    h1{margin:0;font-size:1.25rem}
    p.lead{margin:4px 0 0;color:var(--muted);font-size:0.92rem}

    form{margin-top:20px;display:grid;gap:14px}
    label{font-weight:600;font-size:0.95rem;color:#222}
    input[type="text"], textarea, select{
      width:100%;
      padding:12px;
      border:1px solid #e6e9ed;
      border-radius:8px;
      font-size:0.98rem;
      outline:none;
    }
    textarea{min-height:96px;resize:vertical}
    .row{display:grid;grid-template-columns:1fr 120px;gap:12px}
    .muted{font-size:0.86rem;color:var(--muted)}

    .controls{display:flex;gap:10px;align-items:center;margin-top:6px}
    button{
      background:var(--accent);
      color:white;
      border:0;
      padding:12px 16px;
      border-radius:10px;
      font-weight:700;
      font-size:0.98rem;
      cursor:pointer;
    }
    button:disabled{opacity:0.55;cursor:not-allowed}
    button.secondary{
      background:#f1f5f9;color:#111;border:1px solid #e6e9ed;font-weight:600;
    }

    #loader{display:none;padding:14px;border-radius:8px;background:#fbfcfd;border:1px solid #eef3f7;text-align:center;font-weight:600}
    .show{display:block}

    #results{margin-top:22px;display:grid;gap:16px}
    .card{
      background:#fafafa;border-radius:10px;padding:16px;border:1px solid #f0f2f4;
    }
    .card h2{margin:0 0 8px;font-size:1rem;display:flex;align-items:center;gap:10px}
    .badge{font-size:0.72rem;padding:6px 8px;border-radius:999px;background:#eef2ff;color:#1e3a8a;font-weight:700}

    pre{
      margin:0;background:transparent;border:0;padding:0;white-space:pre-wrap;word-break:break-word;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;font-size:0.95rem;line-height:1.55;color:#0f172a;
    }

    footer{margin-top:20px;font-size:0.86rem;color:var(--muted);display:flex;justify-content:space-between;align-items:center;gap:10px}
    .credit{font-weight:700}
    @media (max-width:640px){
      .row{grid-template-columns:1fr}
      .brand{flex-direction:column;align-items:flex-start;gap:6px}
    }
  </style>
</head>
<body>
  <main>
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true">F</div>
        <div>
          <h1>Friday — AI Songwriter</h1>
          <p class="lead">Created by Mr. Hemanthravi — versions: <span class="badge">Friday 2.5 Pro</span> + <span class="badge">Friday 2.4</span></p>
        </div>
      </div>

      <div style="text-align:right">
        <div class="muted">All-in-one single HTML (paste & run)</div>
        <div style="font-size:0.9rem;margin-top:6px">No external files required</div>
      </div>
    </header>

    <form id="friday-form" aria-labelledby="form-desc" novalidate>
      <div id="form-desc" class="muted">Enter the language, your prompt (theme/mood/lines), and optionally example lyrics to match style.</div>

      <div>
        <label for="song-language">Song Language</label>
        <input id="song-language" name="song-language" type="text" placeholder="e.g., English, Telugu, Hindi" required />
      </div>

      <div>
        <label for="song-prompt">Song Prompt (describe theme / mood / structure)</label>
        <textarea id="song-prompt" name="song-prompt" placeholder="e.g., upbeat pop about summer nights — include chorus & bridge" required></textarea>
      </div>

      <div>
        <label for="example-lyrics">Example Lyrics (for style) — optional</label>
        <textarea id="example-lyrics" name="example-lyrics" placeholder="Paste a short sample lyric to mimic style (optional)"></textarea>
      </div>

      <div class="row">
        <div>
          <label for="voice-mode">Friday Versions</label>
          <select id="voice-mode" name="voice-mode" aria-label="choose versions">
            <option value="both">Original: Friday 2.5 Pro → Corrected: Friday 2.4 (default)</option>
            <option value="only-2.5">Only Friday 2.5 Pro (original)</option>
            <option value="only-2.4">Only Friday 2.4 (corrected)</option>
          </select>
        </div>

        <div style="align-self:end">
          <button id="generate-btn" type="submit">Generate with Friday</button>
        </div>
      </div>

      <div class="controls">
        <button type="button" class="secondary" id="copy-all">Copy All Results</button>
        <div style="flex:1"></div>
        <div class="muted">Webhook URL used by the form is configurable inside the HTML</div>
      </div>
    </form>

    <div id="loader" role="status" aria-live="polite">Generating with Friday…</div>

    <div id="results" hidden>
      <div class="card" id="card-original" style="display:none">
        <h2>Original Song <span class="badge">Friday 2.5 Pro</span></h2>
        <pre id="original-song-output" aria-live="polite"></pre>
      </div>

      <div class="card" id="card-corrected" style="display:none">
        <h2>Corrected Song <span class="badge">Friday 2.4</span></h2>
        <pre id="corrected-song-output" aria-live="polite"></pre>
      </div>
    </div>

    <footer>
      <div>© <span class="credit">Mr. Hemanthravi</span> — Friday AI Songwriter</div>
      <div class="muted">Built for quick testing • Edit webhook & behavior below</div>
    </footer>
  </main>

  <script>
    (function(){
      // -------------------------
      // CONFIG — edit only here:
      // -------------------------
      // 1) Put your n8n webhook production URL here (the form will POST to it).
      //    Keep the placeholder string if you want the "please configure" alert.
      const N8N_WEBHOOK_URL = 'https://openbookai285.app.n8n.cloud/webhook/ai-song-generator-2.5-pro';
      // 2) If you want to test locally without n8n, set this to '' or 'MOCK' and the script will simulate results.
      const MOCK_MODE = false;
      // -------------------------

      // Elements
      const form = document.getElementById('friday-form');
      const generateBtn = document.getElementById('generate-btn');
      const loader = document.getElementById('loader');
      const resultsWrapper = document.getElementById('results');
      const originalCard = document.getElementById('card-original');
      const correctedCard = document.getElementById('card-corrected');
      const originalOutput = document.getElementById('original-song-output');
      const correctedOutput = document.getElementById('corrected-song-output');
      const copyAllBtn = document.getElementById('copy-all');
      const voiceMode = document.getElementById('voice-mode');

      function showLoader(show=true){
        if(show){
          loader.classList.add('show');
          loader.setAttribute('aria-hidden','false');
        } else {
          loader.classList.remove('show');
          loader.setAttribute('aria-hidden','true');
        }
      }

      function showResults(){
        resultsWrapper.hidden = false;
      }

      function hideResults(){
        resultsWrapper.hidden = true;
      }

      function cleanUI(){
        originalOutput.textContent = '';
        correctedOutput.textContent = '';
        originalCard.style.display = 'none';
        correctedCard.style.display = 'none';
      }

      // copy all
      copyAllBtn.addEventListener('click', () => {
        const pieces = [];
        if (originalOutput.textContent.trim()) pieces.push('--- Original (Friday 2.5 Pro) ---\\n' + originalOutput.textContent.trim());
        if (correctedOutput.textContent.trim()) pieces.push('--- Corrected (Friday 2.4) ---\\n' + correctedOutput.textContent.trim());
        if (!pieces.length) return alert('No results to copy yet.');
        const text = pieces.join('\\n\\n');
        navigator.clipboard?.writeText(text).then(()=> alert('Results copied to clipboard'), ()=> alert('Copy failed'));
      });

      // Simulate a mock response (useful when n8n not available)
      function mockResponse(data){
        const lang = data['Song Language'] || 'English';
        const prompt = data['your song prompt'] || 'A heartfelt short chorus';
        const sample = data['example song lyrics'] || '';

        const original = [
          `(${lang}) ORIGINAL — Friday 2.5 Pro`,
          `Prompt: ${prompt}`,
          '',
          `Verse 1:`,
          `Walking down the glowing avenue,`,
          `Neon hearts reflect the truth of you.`,
          '',
          `Chorus:`,
          `We dance until the morning light,`,
          `Hold me close through summer night.`,
          '',
          sample ? ('\nStyle sample used:\n' + sample) : ''
        ].join('\\n');

        const corrected = [
          `(${lang}) CORRECTED — Friday 2.4`,
          `Refined from Friday 2.5 Pro output; tightened phrasing & rhyme.`,
          '',
          `Verse 1:`,
          `On the glowing avenue we sway,`,
          `Neon hearts paint words we couldn't say.`,
          '',
          `Chorus:`,
          `We dance beneath the morning light,`,
          `Hold me close through this summer night.`,
          ''
        ].join('\\n');

        return { originalSong: original, correctedSong: corrected };
      }

      // Submit handler
      form.addEventListener('submit', async (ev) => {
        ev.preventDefault();

        // Basic validation
        const language = (document.getElementById('song-language').value || '').trim();
        const promptText = (document.getElementById('song-prompt').value || '').trim();
        const example = (document.getElementById('example-lyrics').value || '').trim();
        const mode = voiceMode.value;

        if(!language || !promptText){
          alert('Please enter Song Language and Song Prompt.');
          return;
        }

        if (!N8N_WEBHOOK_URL || N8N_WEBHOOK_URL === 'YOUR_N8N_WEBHOOK_PRODUCTION_URL_HERE') {
          alert('Error: Please configure the N8N_WEBHOOK_URL variable at the top of this HTML before using the form.');
          return;
        }

        // Prepare payload (match your n8n webhook expectations)
        const payload = {
          "Song Language": language,
          "your song prompt": promptText,
          "example song lyrics": example,
          "requested_by": "Mr. Hemanthravi",
          "versions": mode
        };

        // UI updates
        generateBtn.disabled = true;
        showLoader(true);
        hideResults();
        cleanUI();

        try {
          let result;
          if (MOCK_MODE || N8N_WEBHOOK_URL.toUpperCase() === 'MOCK') {
            // simulate
            await new Promise(r => setTimeout(r, 800));
            result = mockResponse(payload);
          } else {
            const resp = await fetch(N8N_WEBHOOK_URL, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(payload),
            });

            if (!resp.ok) {
              // Try to parse body for debugging
              let bodyText = '';
              try { bodyText = await resp.text(); } catch (e) { bodyText = 'Unable to read response body'; }
              throw new Error('Webhook request failed — status: ' + resp.status + '\\n' + bodyText);
            }
            // Expecting JSON with keys originalSong and correctedSong (adjust in n8n)
            result = await resp.json();
          }

          // Display based on voice mode selection and returned keys
          if (mode === 'only-2.5' || mode === 'both') {
            if (result.originalSong) {
              originalOutput.textContent = result.originalSong;
            } else if (result.original) {
              originalOutput.textContent = result.original;
            } else {
              originalOutput.textContent = 'No "originalSong" key returned by webhook.';
            }
            originalCard.style.display = 'block';
          }

          if (mode === 'only-2.4' || mode === 'both') {
            if (result.correctedSong) {
              correctedOutput.textContent = result.correctedSong;
            } else if (result.corrected) {
              correctedOutput.textContent = result.corrected;
            } else {
              correctedOutput.textContent = 'No "correctedSong" key returned by webhook.';
            }
            correctedCard.style.display = 'block';
          }

          showResults();

        } catch (err) {
          console.error('Friday generation error:', err);
          // show a user-friendly error in the UI
          originalOutput.textContent = 'An error occurred while generating the song. See console for details.';
          correctedOutput.textContent = '';
          originalCard.style.display = 'block';
          showResults();
        } finally {
          showLoader(false);
          generateBtn.disabled = false;
        }
      });

      // Accessibility: allow Enter to submit from inputs
      ['song-language','song-prompt','example-lyrics'].forEach(id=>{
        const el = document.getElementById(id);
        if(!el) return;
        el.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
            e.preventDefault();
            generateBtn.click();
          }
        });
      });

      // Initial UI state
      cleanUI();
      hideResults();

    })();
  </script>
</body>
</html>
